### JWT 인증 API 테스트
### 사용법: 각 요청 옆의 실행 버튼을 클릭하여 테스트


###############################################
### 1. 회원가입 (Signup)
###############################################
POST http://localhost:8080/api/auth/signup
Content-Type: application/json

{
  "username": "testuser",
  "password": "password123",
  "email": "test@example.com"
}

###############################################
### 2. 회원가입 - 관리자 계정 (테스트용)
###############################################
POST http://localhost:8080/api/auth/signup
Content-Type: application/json

{
  "username": "admin",
  "password": "admin123",
  "email": "admin@example.com"
}


###############################################
### 3. 로그인 (Login) - 토큰 발급
###############################################
POST http://localhost:8080/api/auth/login
Content-Type: application/json

{
  "username": "testuser",
  "password": "password123"
}

# Response에서 accessToken과 refreshToken을 복사하여 아래 테스트에 사용하세요
# 예시:
# {
#   "accessToken": "eyJhbGciOiJIUzI1NiJ9...",
#   "refreshToken": "eyJhbGciOiJIUzI1NiJ9...",
#   "tokenType": "Bearer"
# }


###############################################
### 4. 내 정보 조회 (인증 필요)
###############################################
GET http://localhost:8080/api/user/me
Authorization: Bearer YOUR_ACCESS_TOKEN_HERE

# ⚠️ YOUR_ACCESS_TOKEN_HERE를 위에서 받은 실제 토큰으로 교체하세요


###############################################
### 5. 토큰 없이 접근 시도 (실패 테스트)
###############################################
GET http://localhost:8080/api/user/me

# 예상 결과: 401 Unauthorized 또는 403 Forbidden


###############################################
### 6. 잘못된 토큰으로 접근 (실패 테스트)
###############################################
GET http://localhost:8080/api/user/me
Authorization: Bearer invalid.token.here

# 예상 결과: 401 Unauthorized 또는 403 Forbidden


###############################################
### 7. 토큰 갱신 (Refresh Token)
###############################################
POST http://localhost:8080/api/auth/refresh
Refresh-Token: YOUR_REFRESH_TOKEN_HERE

# ⚠️ YOUR_REFRESH_TOKEN_HERE를 로그인 시 받은 refreshToken으로 교체하세요
# 새로운 accessToken을 발급받습니다


###############################################
### 8. 로그아웃
###############################################
POST http://localhost:8080/api/auth/logout?username=testuser

# 리프레시 토큰이 삭제됩니다


###############################################
### 9. 관리자 전용 엔드포인트 (권한 테스트)
###############################################
GET http://localhost:8080/api/user/admin
Authorization: Bearer YOUR_ACCESS_TOKEN_HERE

# ROLE_USER 권한으로는 접근 불가 (403 Forbidden)
# ROLE_ADMIN 권한이 필요합니다


###############################################
### 추가 테스트 시나리오
###############################################

### 중복 회원가입 시도 (실패 테스트)
POST http://localhost:8080/api/auth/signup
Content-Type: application/json

{
  "username": "testuser",
  "password": "password123",
  "email": "test@example.com"
}

# 예상 결과: "이미 존재하는 사용자명입니다."


### 잘못된 비밀번호로 로그인 (실패 테스트)
POST http://localhost:8080/api/auth/login
Content-Type: application/json

{
  "username": "testuser",
  "password": "wrongpassword"
}

# 예상 결과: 401 Unauthorized


###############################################
### H2 Database Console
###############################################
# 브라우저에서 접속: http://localhost:8080/h2-console
# JDBC URL: jdbc:h2:mem:testdb
# User Name: sa
# Password: (비워두기)
#
# 확인할 쿼리:
# SELECT * FROM USERS;
# SELECT * FROM REFRESH_TOKENS;
